<!--
// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy current the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
// -->
<configuration>
    <!-- Context is evaluated first. -->
    <context>
        <context-entry name="stage">${properties:system:STAGE?default=DEV}</context-entry>
        <context-entry name="app">${properties:system.APP?default=NONE}</context-entry>
        <context-entry name="context">${java:org.apache.tamaya.context.Context#id()}</context-entry>
        <context-entry name="company">Trivadis</context-entry>
        <context-entry name="default-formats">yaml,json</context-entry>
    </context>

    <!-- Configuration definition. -->

    <config-sources>
       <source enabled="${stage=TEST || stage=PTA || stage=PROD}"
           uri="properties:environment">
           <filter type="mapping">ENV.</filter>
           <filter type="access-control">
               <param name="roles">admin,power-user</param>
               <param name="policy">mask</param>
           </filter>
       </source>
       <source uri="properties:system"/>
       <source name="FILE:config.json" refresh-period="5000"
               uri="file:/./config.json" >
           <param name="observe-period">20000</param>
           <param name="formats">json</param>
       </source>
       <source-provider name="classpath:application-config.yml" uri="classpath*://META-INF/application-config.yml">
           <param name="formats">yaml</param>
       </source-provider>
       <source name="MINE" uri="class:ch.mypack.MyClassSource">
           <param name="locale">de</param>
        </source>
       <include enabled="${stage==TEST}">TEST-config.xml</include>
       <source-provider name="CONFIG-DIR" uri="resource:/${CONFIG-DIR}/**/*.json"/>
       <source name="SERVER" uri="https://www.confdrive.com/cfg/customerId=${}">
           <param name="locale">de</param>
       </source>
    </config-sources>
    <config-filters>
        <filter type="UsageTrackerFilter"/>
        <filter type="access-control">
            <param name="roles">admin,power-user</param>
            <param name="policy">hide</param>
            <param name="expression">*.secret</param>
        </filter>
        <filter type="Cache">
            <param name="ttl">30000</param>
            <param name="expression">cached.*</param>
        </filter>
    </config-filters>
    <!--<converters>-->
    <!--<converter type="AllInOneConverter"/>-->
    <!--</converters>-->

</configuration>

